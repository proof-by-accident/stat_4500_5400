---
title: "Lecture 1- A Bracing Tour of Simple Linear Regression with R"
author: "Peter Shaffery"
date: "12/31/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

## Example: Penguins!
<!--
![](https://www.chimuadventures.com/blog/wp-content/uploads/2016/04/Chinstrap_Penguins_shutterstock_142890634.jpg)
-->

```{r message=FALSE}
library(palmerpenguins)
```
Say that we are researchers studying penguins in the Palmer Archipelago of Antarctica. We have collected data on three different penguin species (Adelie, Chinstrap, and Gentoo) on three different islands (Torgersen, Biscoe, and Dream). For each subject in our dataset, we have recorded the following:

* length and depth of the bill (mm)
* length of the flippers (mm)
* body mass (g)
* sex
* year of the measurement

The data looks like this:
```{r}
penguins
```

We are interested in the relationship between body mass ($x$) and flipper length ($y$)
```{r}
dat = tidyr::drop_na(penguins)
x = dat$flipper_length_mm
y = dat$body_mass_g
plot(x,y,
     main='Body Mass and Flipper Length',
     xlab='Body Mass (g)',
     ylab='Flipper Length (mm)')
```

### Correlation
They certainly *look* related, but how can we quantify this? One way is by using *correlation*. The idea here is to divide the scatter plot into quadrants, based on $\bar{x} = \frac{1}{n} \sum x_i$ and $\bar{y} = \frac{1}{n} \sum y_i$ 
```{r}
x.bar = mean(x)
y.bar = mean(y)

plot(x,y,
     main='Body Mass and Flipper Length',
     xlab='Body Mass (g)',
     ylab='Flipper Length (mm)')
abline(v=x.bar, col='red')
abline(h=y.bar, col='red')
```

Notice that if flipper length *increases* with body mass than most points will in the upper right and lower left quadrants. That is to say, when the relationship is increasing then for most observations $x_i>\bar{x}$ and $y_i>\bar{y}$, or $x_i<\bar{x}$ and $y_i<\bar{y}$. Thus the product $(x_i - \bar{x})(y_i - \bar{y})$ will usually be *positive*. This leads us to define **covariance**:
$$
\text{Cov}(x_i,y_i) = \frac{1}{n-1} \sum\limits_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})
$$
When covariance is positive then *on average* points fall into either the upper right or lower left quadrants. When covariance is negative then the opposite must hold. **Cov$(x,y)$ measures whether an increasing or decreasing relationship holds between $x$ and $y$, on average**

```{r}
n = length(x)
cov1 = (1/(n-1)) * sum((x-x.bar)*(y-y.bar))
cov2 = cov(x,y)

c(cov1,cov2)
```
Say our collaborators use pounds (lbs) instead of grams (g). 1 pound is equal to about 454 grams, let's convert $x$ to pounds, and calculate covariance again:
```{r}
x.lbs = x/454
cov(x.lbs,y)
```
We got a totally different value! Note that the sign is still positive, but the value is two orders of magnitude smaller. It's therefore usually more convenient to work with *correlation*, which is scale invariant:
$$
\text{Cor}(x_i,y_i) = \frac{\text{Cov}(x,y)}{s_x s_y}
$$
Where $s_x$ and $s_y$ are the standard deviations of $x$ and $y$:
$$
s_x = \sqrt{ \text{Var}[x] } = \sqrt{ \frac{1}{n} \sum\limits_{i=1}^n (x_i - \bar{x})^2 }
$$


```{r}
cor(x,y)
cor(x.lbs,y)
```
Like covariance, correlation can be positive (when a relationship is increasing) or negative (when a relationship is decreasing), however unlike covariance correlations is bounded to the interval $[-1,1]$.
